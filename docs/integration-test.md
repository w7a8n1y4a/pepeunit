# Интеграционные тесты

:::tip Какую роль выполняют интеграционные тесты в приложении?
Интеграционные тесты позволяют протестирововать корректность работы основных сценариев приложения, а также вывести ряд метрик работы системы для администраторов и разработчиков.
:::

:::warning 
Все сценарии выполняемые в рамках интеграционных тестов, проверяют исключительно бизнеслогику, они не стремятся проверить то как работает какой-либо из слоёв API.
:::

## Cценарии User

### Сценарий 1 - Cоздание
- Создать пользователей
- Попытаться создать пользователя с существующим login
- Установить роль Админа одному из пользователей

### Сценарий 2 - Авторизация
- Получить токен авторизации для всех пользователей
- Попытаться получить токен с не валидным password
- Попытаться получить токен с не валидным login

### Сценарий 3 - Верификация
- Проверить верификация с несуществующим кодом
- Сгенерировать верификационный код всем созданным пользователям
- Проверить верификационный код для всех созданных пользователей
- Проверить что кодов больше нет в redis

### Сценарий 4 - Блокировка и Разблокировка
- Заблокировать пользователя
- Разблокировать пользователя
- Попытаться заблокировать пользователя не имея прав
- Попытаться разблокировать пользователя не имея прав

### Сценарий 5 - Модификация
- Обновить логин на не занятый
- Обновить логин на занятый
- Проверка обновления пароля

### Сценарий 6 - Множественная выборка
- Выборка со всеми параметрами для получения списка

## Cценарии Repo

### Сценарий 1 - Создание
- Создать открытый/закрытый repo gitlab
- Создать открытый/закрытый repo github
- Создать Repo с разными уровнями видимости
- Попытаться создать Repo с существующим именем
- Попытаться создать Repo с невалидным url
- Попытаться создать Repo с невалидными кредами

### Cценарий 2 - Модификация 
- Установить всем repo default ветку
- Обновить название на не занятое
- Обновить название на занятое
- Изменить автоматическое обновление на ручное и установить частоту этого обновления

### Cценарий 3 - Получить все комиты по ветке
- Получить первые 10 коммитов
- Проверить первый коммит
- Проверить выборку коммитов для не существующей ветки 

### Сценарий 4 - Обновить креды
Для закрытых репозиториев gitlab и github

- Обновить креды на невалидные
- Попробовать обновить репозиторий с невалидными кредами
- Обновить креды на валидные

### Сценарий 5 - Установить ветку по умолчанию
- Для всех тестовых Repo - проставить каждой из сущностей первую ветку по умолчанию 
- Попробовать проставить не существующую ветку по умолчанию

### Сценарий 6 - Обновить физический репозиторий
- Удалить один из тестовых физических Repo
- Обновить все тестовые физические Repo

### Сценарий 7 - Удаление
- Удалить репозиторий к которому не присоеденены Unit

### Сценарий 8 - Множественная выборка
- Выборка по создателю и автообновляемости
- Выборка со всеми параметрами

## Сценарии Unit

### Сценарий 1 - Создание
- Создать автообновлеяемый Unit
- Создать не автообновляемый Unit с установкой стандартного обновления
- Создать Unit с существующим именем
- Создать все 3 варианта видимости
- Создать Unit для каждого из Repo
- Попытаться создать для Repo у которого нет стандарной ветки
- Создать Unit от верссии Repo у котороq нет env_example.json
- Создать Unit от верссии Repo у котороq нет schema.json
- Создать Unit с существующим именем

### Cценарий 2 - Модификация 
- Обновить название
- Обновить название на занятое
- Обновление видимости
- Изменить автоматическое обновление от Repo на ручное
- Изменить ручное обновление на автоматическое

### Cценарий 3 - Работа с файлом окружения
- Получить файл окружения для версий в которых они есть
- Получить файл окружения для версий в которых их нет
- Установить значения в файле окружения как надо
- Установить значения в файле окружения как не надо
- Сделать всем нужным Unit хорошие env.json, кроме одного

### Сценарий 4 - Обновление прошивок
- Перевести разные Unit на существующие версии
- Перевести Unit на несущетвующую версию
- Перевести Unit на версию с невалидным env_example.json
- Перевести Unit на версию с невалидным schema.json
- Попробовать обновить с невалидным env.json

### Сценарий 5 - Получение прошивки
- Получить прошивку zip и проверить файлы
- Получить прошивку tar и проверить файлы
- Получить прошивку tgz и проверить файлы

### Сценарий 6 - Удаление
- Удалить Unit

### Сценарий 7 - Множественная выборка
- Выборка по создателю
- Выборка по Repo
- Выборка по автообновляемости

### Сценарий 8 - Взаимодействие
- Взаимодействие двух UnitNode - Public - Public
- Взаимодействие двух UnitNode - Internal - Internal
- Взаимодействие двух UnitNode - Private - Private
- Взаимодействие двух UnitNode - Public - Internal
- Взаимодействие двух UnitNode - Internal - Private
- Взаимодействие двух UnitNode - Public - Private
- Попробывать ещё все эти взаимодействия с обявленем доступов и без

### Сценарий 9 - Проверка удаляемости Repo
- Проверить удаляемость Repo, если есть хотябы 1 Unit

### Сценарий 10 - Обновление Unit связанных Repo
- Перевести часть Unit на старые версии
- Часть Unit должны быть автообновляемыми часть нет
- Обновить через метод Repo связанные Unit
- Проверить что обновилось, а что нет

## Сценарии UnitNode

### Cценарий 1 - Модификация 
- Обновить видимость
- Обновить для Input презаписываемость
- Обновить для Output презаписываемость

### Сценарий 2 - Установить значения
- Получить некоторый UnitNode
- Установить значение в state
- Установить значение по топику

### Сценарий 3 - Множественная выборка
- Выборка по Unit
