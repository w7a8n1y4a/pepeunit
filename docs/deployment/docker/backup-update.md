# Бэкапы и обновление

## Работа с бэкапами

0. Запустите `Pepeunit` командой, это требуется для получения корректной версии
    ```bash
    docker compose up -d
    ```
1. Запустите создание `backup` командой, бекап делается без прекращения работы контейнеров
    ```bash
    sudo ./backup.sh backup
    ```
1. Развернуть версию из `backup`, инстанс при этом изначально должен быть полностью выключен командой `docker compose down`
    ```bash
    sudo ./backup.sh restore backups/backup_name.tar
    ```

## Обновление

0. Создайте `backup`
    ```bash
    sudo ./backup.sh backup
    ```
1. Выполните обновление репозитория
    ```bash
    git pull
    ```
1. Выполните обновление `env` переменных. Существующие секретные `32 битные ключи` изменены не будут. Остальные переменные будут сгенерированны, как при первой генерации, если вы выполняли ручной ввод данных в `env/.env.<service-name>` файлы, то ваши изменения будут **УДАЛЕНЫ**, поэтому обязательно делайте `backup` перед запуском команды. Если у вас очень тонкая настройка, изменяйте настройки в ручную, напрямую в `env/.env.<service-name>`.
    ```bash
    python make_env.py
    ```
1. Выполните запуск `Pepeunit`
    ```bash
    docker compose up -d
    ```